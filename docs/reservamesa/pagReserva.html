<!DOCTYPE html>
<html lang="pt-BR">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="pagReserva.css">
        <link rel="shortcut icon" href="../imagens/Logo.jpeg" type="image/x-icon">
        <title>Esme Sweet Cake</title>
    </head>
    <body>
        <header id="home" class="header">
            <div class="top-header">
                <div class="logo">
                    <h1>Esme Sweet Cake</h1>
                </div>
            </div>
        </header>
        <main class="main">
            <h1>Reserve sua mesa aqui:</h1><br>
            <form id="reservationForm">
                <label for="name">Nome:</label>
                <input type="text" id="name" name="name" placeholder="Insira seu Nome" required>
                <br>
                <label for="peopleQtt">Quantidade de pessoas:</label>
                <input type="number" id="peopleQtt" name="peopleQtt" placeholder="Insira a Quantidade" required>
                <br>
                <label for="reservationDate">Data:</label>
                <input type="date" id="reservationDate" name="reservationDate" required>
                <br>
                <label for="reservationTime">Horário:</label>
                <input type="time" id="reservationTime" name="reservationTime" required>
                <br>
                <label>Área do Estabelecimento:</label>
                <input type="radio" id="areaInterno" name="area" value="inter" checked>
                <label for="areaInterno">Interno</label>
                <input type="radio" id="areaExterno" name="area" value="exter">
                <label for="areaExterno">Externo</label>
                <input type="radio" id="areaExternoCoberto" name="area" value="extco">
                <label for="areaExternoCoberto">Externo Coberto</label>
                <br><br>
                <button type="submit" class="btn2"><p class="txtB">Enviar</p></button>
            </form>
            <div class="button-container">
               <button type="button" class="btn"><p><a href="../index.html"><img src="../assets/img/home.png" alt="home" class="btn-img"/></a></p></button>
            </div>
        </main>
        <footer class="footer">Desenvolvido por InovaDevs</footer>
        
    </body>
    <script>
        document.getElementById('reservationForm').addEventListener('submit', async function (event) {
            event.preventDefault(); // Previne o comportamento padrão do formulário

            const formData = {
                name: document.getElementById('name').value,
                userId: 1,
                productId: 1,
                peopleQtt: document.getElementById('peopleQtt').value,
                reservationDate: document.getElementById('reservationDate').value,
                reservationTime: document.getElementById('reservationTime').value,
                status: "Pendente",
                area: document.querySelector('input[name="area"]:checked').value // Corrigido aqui
            };

            try {
                console.log(JSON.stringify(formData));
                const response = await fetch('https://inovadevsapi.onrender.com/service/reservationService/createReservation.php', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(formData)
                });
                document.getElementById('reservationForm').reset();

                const result = await response.json();
                
                if (response.ok) {
                    showNotification(result.message, 'success');
                } else {
                    showNotification(result.message || 'Erro ao criar reserva.', 'error');
                }
            } catch (error) {
                showNotification('Erro de conexão com o servidor.', 'error');
            }
        });

        function showNotification(message, type) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = 'notification'; // Reseta as classes
            if (type === 'error') {
                notification.classList.add('error');
            }
            notification.style.display = 'block';

            setTimeout(() => {
                notification.style.display = 'none';
            }, 3000); // Mensagem desaparece após 3 segundos
        }
    </script>
</html>
